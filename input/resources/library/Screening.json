{
  "resourceType": "Library",
  "id": "Screening",
  "extension": [ {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://fhir.org/guides/nachc/hiv-cds/Library/Screening",
  "name": "Screening",
  "title": "Library - HIV Screening",
  "type": {
    "coding": [ {
      "system": "http://hl7.org/fhir/ValueSet/library-type",
      "version": "4.0.1",
      "code": "logic-library",
      "display": "Logic Library"
    } ]
  },
  "subjectCodeableConcept": {
    "coding": [ {
      "system": "http://hl7.org/fhir/ValueSet/subject-type",
      "version": "4.0.1",
      "code": "Patient",
      "display": "Patient"
    } ]
  },
  "date": "2021-05-12T00:00:00-07:00",
  "publisher": "National Association of Community Health Centers, Inc. (NACHC)",
  "contact": [ {
    "telecom": [ {
      "system": "url",
      "value": "https://www.nachc.org/"
    } ]
  } ],
  "description": "Logic library for implementation of the CDC HIV Screening Recommendation.",
  "useContext": [ {
    "code": {
      "system": "http://hl7.org/fhir/usage-context-type",
      "version": "4.0.1",
      "code": "focus",
      "display": "Clinical Focus"
    },
    "valueCodeableConcept": {
      "coding": [ {
        "system": "http://hl7.org/fhir/sid/icd-10-cm",
        "version": "2021",
        "code": "B20",
        "display": "Human immunodeficiency virus [HIV] disease"
      } ]
    }
  } ],
  "jurisdiction": [ {
    "coding": [ {
      "system": "http://hl7.org/fhir/ValueSet/iso3166-1-3",
      "version": "4.0.1",
      "code": "USA",
      "display": "United States of America"
    } ]
  } ],
  "purpose": "The purpose of this is to implement a Clinical Decision Support Workflow via CDS-Hooks to establish the CDC's HIV Screening Recommendation.",
  "usage": "This is to be used in conjunction with a patient-facing FHIR application.",
  "copyright": "Â© Copyright National Association of Community Health Centers, Inc. (NACHC) 2021+.",
  "topic": [ {
    "coding": [ {
      "system": "http://hl7.org/fhir/ValueSet/definition-topic",
      "version": "4.0.1",
      "code": "assessment",
      "display": "Assessment"
    } ],
    "text": "HIV Management"
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBTY3JlZW5pbmcKCnVzaW5nIEZISVIgdmVyc2lvbiAnNC4wLjEnCgppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuMC4xJwppbmNsdWRlIEZISVJDb21tb24gY2FsbGVkIEZDCgppbmNsdWRlIE5BQ0hDQ29tbW9uIGNhbGxlZCBOQwppbmNsdWRlIEhJVkNvbW1vbiBjYWxsZWQgSEMKaW5jbHVkZSBISVZDb25jZXB0cyBjYWxsZWQgQ3gKCmluY2x1ZGUgSElWRGF0YUVsZW1lbnRzIGNhbGxlZCBIREUKCmNvbnRleHQgUGF0aWVudAoKZGVmaW5lICJJbmZvIjoKICAnaW5mbycKCmRlZmluZSAiV2FybmluZyI6CiAgJ3dhcm5pbmcnCgpkZWZpbmUgIkNyaXRpY2FsIjoKICAnY3JpdGljYWwnCgpkZWZpbmUgIkVycm9ycyI6CiAgbnVsbAoKZGVmaW5lICJQYXRpZW50IE5hbWUiOgogIEZpcnN0KFBhdGllbnQubmFtZS5naXZlbikKICAgKyAnICcgKwogIEZpcnN0KFBhdGllbnQubmFtZS5mYW1pbHkpCgoKLyogUmVjb21tZW5kYXRpb24gQ3JpdGVyaWEgLSBISVYgU2NyZWVuaW5nICAqLwpkZWZpbmUgIk1lZXRzIEluY2x1c2lvbiBDcml0ZXJpYSI6CiAiUGF0aWVudCBpcyBiZXR3ZWVuIDEzIGFuZCA2NCB5ZWFycyBvbGQiCiBvciAiUGF0aWVudCBpcyBTZWVraW5nIFRyZWF0bWVudCBmb3IgYW4gU1REIgoKZGVmaW5lICJNZWV0cyBFeGNsdXNpb24gQ3JpdGVyaWEiOgogICJBY3RpdmUgRGlhZ25vc2lzIG9mIEhJViBEdXJpbmcgUGF0aWVudCBWaXNpdCIgaXMgbm90IG51bGwKCmRlZmluZSAiSW4gUG9wdWxhdGlvbiI6CiAgIk1lZXRzIEluY2x1c2lvbiBDcml0ZXJpYSIKICBhbmQgbm90ICJNZWV0cyBFeGNsdXNpb24gQ3JpdGVyaWEiCgovKiBPUFRJT05TOgoKICAgIDEuIFJlY29tbWVuZCBTY3JlZW5pbmcgMyBtb250aHMgKEhpZ2ggUmlzayAtIENEQyBSaXNrIEZhY3RvcnMpCiAgICAyLiBSZWNvbW1lbmQgU2NyZWVuaW5nIEFubnVhbGx5IChNb2RlcmF0ZSBSaXNrIC0gU09HSSBSaXNrIEZhY3RvcnMpCiAgICAzLiBObyBSZWNvbW1lbmRhdGlvbiBTY3JlZW5pbmcgKE5vIFJpc2spIC8gTG93IFJpc2sKICAgIDQuIFJlY29tbWVuZCBTY3JlZW5pbmcgQ3VzdG9tIFBlcmlvZHMgKDMgbW9udGhzIGJhc2VkIG9uIHNwZWNpZmljIHJpc2sgZmFjdG9yIC0tIHNleHVhbGx5IGFjdGl2ZSBNU00gdy8gcHJlcCwgZXRjKQogICAgICAvLyBNU00gLyBQcmVnbmFuY3kgLyBDREMgUmVjb21tZW5kYXRpb24KCiAgLy8gLSBIaWdoIFJpc2sKICAgIC8vIENEQyBSSVNLIEZBQ1RPUlMKICAgIC8vIERydWcgQWJ1c2UgKERBU1QtMTApCgogIC8vIC0gTWVkaXVtIFJpc2sKICAgIC8vIFNPR0kgRUxFTUVOVFMKCiAgLy8gLSBObyBSaXNrCiAgICAvLyBEb2N1bWVudGVkIG5vdCBTZXh1YWxseSBBY3RpdmUgKFJpc2sgRmFjdG9ycyBRdWVzdGlvbm5haXJlIERFIDEzIC8gMTQpCgogIC8vIC0gTG93IFJpc2sKICAgIC8vIERFRkFVTFQKCiAgLy8gVEVTVCBPUkRFUjoKICAgIE5lZWRzIEFjdGl2aXR5RGVmaW5pdGlvbiBpbiB0aGUgUGxhbkRlZmluaXRpb24uCiAgICBOZWVkIHRvIGJlIGFibGUgdG8gc3BlY2lmeSB3aGF0IHRoZXkgYXJlIG9yZGVyaW5nIGluIHRoZSBjb25maWd1cmF0aW9uLgogICAgU2VydmljZVJlcXVlc3QgdXNpbmcgRGF0YSBFbGVtZW50IE9yZGVyZWQgQ29kZXMKCgogIC8vIFRPRE86CiAgU25vb3plIE9wdGlvbnMgLyBPdmVycmlkZToKICAgIEFjY2VwdCAtIFBsYWNlIG9yZGVyCiAgICBEb2N1bWVudCBUZXN0IC0gQUNUSU9OOiBRdWVzdGlvbm5haXJlIHRvIHN1cHBvcnQgZG9jdW1lbnRpbmcgdGVzdAogICAgU25vb3plIC0gMSBtb250aAogICAgU25vb3plIC0gMTIgbW9udGhzCiAgICBQYXRpZW50IERlY2xpbmVkIC0gQUNUSU9OOiBEb2N1bWVudCBwYXRpZW50IHByZWZlcmVuY2UKCiovCgovKgoKT1JERVI6CiAgMS4gTmV2ZXIgVEVTVEVECiAgMi4gQ0RDIEVkZ2UgQ2FzZXMgKE1TTSAmIFByZWduYW5jeSkKICAzLlJpc2sgU2NvcmluZwogICAgYS4gSGlnaCBSaXNrCiAgICBiLiBNb2RlcmF0ZSBSaXNrCiAgICBjLiBMb3cgUmlzayAvIE5vIFJpc2sKCiovCgovLyBORVZFUiBURVNURUQKZGVmaW5lICJOZXZlciBUZXN0ZWQgQ29uZGl0aW9uIjoKICAiSW4gUG9wdWxhdGlvbiIKICBhbmQgbm90ICJQYXRpZW50IGhhcyBoYWQgYW4gSElWIFNjcmVlbmluZyIKCmRlZmluZSAiTmV2ZXIgVGVzdGVkIFJlY29tbWVuZGF0aW9uIjoKICAnSElWIFNjcmVlbmluZyBSZWNvbW1lbmRlZCBkdWUgdG8gcGF0aWVudCBuZXZlciBoYXZpbmcgYmVlbiB0ZXN0ZWQuJwoKZGVmaW5lICJOZXZlciBUZXN0ZWQgUmF0aW9uYWxlIjoKICAnQ0RDIHJlY29tbWVuZHMgdGhhdCBkaWFnbm9zdGljIEhJViB0ZXN0aW5nIGFuZCBvcHQtb3V0IEhJViBzY3JlZW5pbmcgYmUgYSBwYXJ0IG9mIHJvdXRpbmUgY2xpbmljYWwgY2FyZSBpbiBhbGwgaGVhbHRoLWNhcmUgc2V0dGluZ3Mgd2hpbGUgYWxzbyBwcmVzZXJ2aW5nIHRoZSBwYXRpZW50cyBvcHRpb24gdG8gZGVjbGluZSBISVYgdGVzdGluZyBhbmQgZW5zdXJpbmcgYSBwcm92aWRlci1wYXRpZW50IHJlbGF0aW9uc2hpcCBjb25kdWNpdmUgdG8gb3B0aW1hbCBjbGluaWNhbCBhbmQgcHJldmVudGl2ZSBjYXJlLicKCmRlZmluZSAiTmV2ZXIgVGVzdGVkIEluZGljYXRvciI6CiAgIkluZm8iCgoKLyogQ0RDIEVER0UgQ0FTRVMgKi8KLy8gTVNNCmRlZmluZSAiTVNNIENvbmRpdGlvbiI6CiAgIkluIFBvcHVsYXRpb24iCiAgYW5kICgKICAgICJQYXRpZW50IGlzIGEgU2V4dWFsbHkgQWN0aXZlIE1TTSB3aG8gc2hvdWxkIGJlIFNjcmVlbmVkIEV2ZXJ5IDMgTW9udGhzIgogICAgb3IgIlBhdGllbnQgaXMgYSBTZXh1YWxseSBBY3RpdmUgTVNNIHdobyBzaG91bGQgYmUgU2NyZWVuZWQgQW5udWFsbHkiCiAgKQoKZGVmaW5lICJNU00gUmVjb21tZW5kYXRpb24iOgogIGlmICJQYXRpZW50IGlzIGEgU2V4dWFsbHkgQWN0aXZlIE1TTSB3aG8gc2hvdWxkIGJlIFNjcmVlbmVkIEV2ZXJ5IDMgTW9udGhzIiB0aGVuCiAgICAnVGhyZWUgTW9udGggSElWIFNjcmVlbmluZyBSZWNvbW1lbmRlZCBkdWUgdG8gcGF0aWVudCBiZWluZyBhIHNleHVhbGx5IGFjdGl2ZSBNU00gd2hvIGhhcyBiZWVuIHByZXNjcmliZWQgUHJFUCBpbiB0aGUgcGFzdC4nCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBhIFNleHVhbGx5IEFjdGl2ZSBNU00gd2hvIHNob3VsZCBiZSBTY3JlZW5lZCBBbm51YWxseSIgdGhlbgogICAgJ0FubnVhbCBISVYgU2NyZWVuaW5nIFJlY29tbWVuZGVkIGR1ZSB0byBwYXRpZW50IGJlaW5nIGEgc2V4dWFsbHkgYWN0aXZlIE1TTSB3aXRob3V0IEhJViBhbmQgaGFzIGhhZCBtdWx0aXBsZSBzZXggcGFydG5lcnMuJwogIGVsc2UgJ0hJViBTY3JlZW5pbmcgTm90IFJlY29tbWVuZGVkIGF0IHRoaXMgdGltZS4gSXQgaGFzIGJlZW4gJyArIFRvU3RyaW5nKCJBbW91bnQgb2YgRGF5cyBTaW5jZSBQcmV2aW91cyBISVYgU2NyZWVuaW5nIikgKyAnIGRheXMgc2luY2UgbGFzdCBISVYgU2NyZWVuaW5nLicKCmRlZmluZSAiTVNNIFJhdGlvbmFsZSI6CiAgJ0Ftb25nIHlvdW5nIChhZ2VkIDE4LS0yNCB5ZWFycykgbWVuIHdobyBoYXZlIHNleCB3aXRoIG1lbiAoTVNNKSBzdXJ2ZXllZCBkdXJpbmcgMjAwNC0tMjAwNSBpbiBmaXZlIFUuUy4gY2l0aWVzLCAxNCUgd2VyZSBpbmZlY3RlZCB3aXRoIEhJVjsgNzklIG9mIHRoZXNlIEhJVi1pbmZlY3RlZCBNU00gd2VyZSB1bmF3YXJlIG9mIHRoZWlyIGluZmVjdGlvbi4nCgpkZWZpbmUgIk1TTSBJbmRpY2F0b3IiOgogIGlmICJQYXRpZW50IGlzIGEgU2V4dWFsbHkgQWN0aXZlIE1TTSB3aG8gc2hvdWxkIGJlIFNjcmVlbmVkIEV2ZXJ5IDMgTW9udGhzIiB0aGVuICJXYXJuaW5nIgogIGVsc2UgIldhcm5pbmciCgoKLy8gUFJFR05BTkNZCmRlZmluZSAiUHJlZ25hbnQgQ29uZGl0aW9uIjoKICAiSW4gUG9wdWxhdGlvbiIKICBhbmQgKAogICAgIlBhdGllbnQgaXMgYXQgRmlyc3QgUHJlbmF0YWwgVmlzaXQiCiAgICBvciAiUGF0aWVudCBpcyBIaWdoIFJpc2sgaW4gVGhpcmQgVHJpbWVzdGVyIG9mIFByZWduYW5jeSIKICApCgpkZWZpbmUgIlByZWduYW50IFJlY29tbWVuZGF0aW9uIjoKICBpZiAiUGF0aWVudCBpcyBhdCBGaXJzdCBQcmVuYXRhbCBWaXNpdCIgYW5kICJPdmVyIDMgTW9udGhzIGhhcyBQYXN0IFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciIHRoZW4KICAgICdISVYgU2NyZWVuaW5nIFJlY29tbWVuZGVkIG5vdyBkdWUgdG8gcGF0aWVudCBiZWluZyBhdCBmaXJzdCBwcmVuYXRhbCB2aXNpdC4nCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBIaWdoIFJpc2sgaW4gVGhpcmQgVHJpbWVzdGVyIG9mIFByZWduYW5jeSIgYW5kICJPdmVyIDMgTW9udGhzIGhhcyBQYXN0IFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciIHRoZW4KICAgICdISVYgU2NyZWVuaW5nIFJlY29tbWVuZGVkIGR1ZSB0byBwYXRpZW50IGJlaW5nIGF0IGhpZ2ggcmlzayBvZiBISVYgZHVyaW5nIHRoaXJkIHRyaW1lc3RlciBvZiBwcmVnbmFuY3kuJwogIGVsc2UgJ0hJViBTY3JlZW5pbmcgTm90IFJlY29tbWVuZGVkIGF0IHRoaXMgdGltZS4gSXQgaGFzIGJlZW4gJyArIFRvU3RyaW5nKCJBbW91bnQgb2YgRGF5cyBTaW5jZSBQcmV2aW91cyBISVYgU2NyZWVuaW5nIikgKyAnIGRheXMgc2luY2UgbGFzdCBISVYgU2NyZWVuaW5nLicKCmRlZmluZSAiUHJlZ25hbnQgUmF0aW9uYWxlIjoKICBpZiAiUGF0aWVudCBpcyBhdCBGaXJzdCBQcmVuYXRhbCBWaXNpdCIgdGhlbgogICAgJ1RvIHByb21vdGUgaW5mb3JtZWQgYW5kIHRpbWVseSB0aGVyYXBldXRpYyBkZWNpc2lvbnMsIGhlYWx0aC1jYXJlIHByb3ZpZGVycyBzaG91bGQgdGVzdCB3b21lbiBmb3IgSElWIGFzIGVhcmx5IGFzIHBvc3NpYmxlIGR1cmluZyBlYWNoIHByZWduYW5jeS4gV29tZW4gd2hvIGRlY2xpbmUgdGhlIHRlc3QgZWFybHkgaW4gcHJlbmF0YWwgY2FyZSBzaG91bGQgYmUgZW5jb3VyYWdlZCB0byBiZSB0ZXN0ZWQgYXQgYSBzdWJzZXF1ZW50IHZpc2l0LicKICBlbHNlIGlmICJQYXRpZW50IGlzIEhpZ2ggUmlzayBpbiBUaGlyZCBUcmltZXN0ZXIgb2YgUHJlZ25hbmN5IiB0aGVuCiAgICAnQSBzZWNvbmQgSElWIHRlc3QgZHVyaW5nIHRoZSB0aGlyZCB0cmltZXN0ZXIgZm9yIHdvbWVuIGluIHNldHRpbmdzIHdpdGggZWxldmF0ZWQgSElWIGluY2lkZW5jZSAoPjE3IGNhc2VzIHBlciAxMDAsMDAwIHBlcnNvbi15ZWFycykgaXMgY29zdC1lZmZlY3RpdmUgYW5kIG1pZ2h0IHJlc3VsdCBpbiBzdWJzdGFudGlhbCByZWR1Y3Rpb25zIGluIG1vdGhlci10by1jaGlsZCBISVYgdHJhbnNtaXNzaW9uLicKICBlbHNlICcnCgpkZWZpbmUgIlByZWduYW50IEluZGljYXRvciI6CiAgaWYgIlBhdGllbnQgaXMgYXQgRmlyc3QgUHJlbmF0YWwgVmlzaXQiIHRoZW4gIkluZm8iCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBIaWdoIFJpc2sgaW4gVGhpcmQgVHJpbWVzdGVyIG9mIFByZWduYW5jeSIgdGhlbiAiQ3JpdGljYWwiCiAgZWxzZSAiSW5mbyIKCgovLyBTRUVLSU5HIFRSRUFUTUVOVApkZWZpbmUgIlNlZWtpbmcgU1REIFRyZWF0bWVudCBDb25kaXRpb24iOgogICJJbiBQb3B1bGF0aW9uIgogIGFuZCAiUGF0aWVudCBpcyBTZWVraW5nIFRyZWF0bWVudCBmb3IgYW4gU1REIgoKZGVmaW5lICJTZWVraW5nIFNURCBUcmVhdG1lbnQgUmVjb21tZW5kYXRpb24iOgogIGlmICJPdmVyIDMgTW9udGhzIGhhcyBQYXN0IFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciIHRoZW4gJ0hJViBTY3JlZW5pbmcgUmVjb21tZW5kZWQgbm93IGR1ZSB0byBwYXRpZW50IGludGVyZXN0LicKICBlbHNlICdISVYgU2NyZWVuaW5nIE5vdCBSZWNvbW1lbmRlZCBhdCB0aGlzIHRpbWUuIEl0IGhhcyBiZWVuICcgKyBUb1N0cmluZygiQW1vdW50IG9mIERheXMgU2luY2UgUHJldmlvdXMgSElWIFNjcmVlbmluZyIpICsgJyBkYXlzIHNpbmNlIGxhc3QgSElWIFNjcmVlbmluZy4nCgpkZWZpbmUgIlNlZWtpbmcgU1REIFRyZWF0bWVudCBSYXRpb25hbGUiOgogICdBbGwgcGF0aWVudHMgc2Vla2luZyB0cmVhdG1lbnQgZm9yIFNURHMsIGluY2x1ZGluZyBhbGwgcGF0aWVudHMgYXR0ZW5kaW5nIFNURCBjbGluaWNzLCBzaG91bGQgYmUgc2NyZWVuZWQgcm91dGluZWx5IGZvciBISVYgZHVyaW5nIGVhY2ggdmlzaXQgZm9yIGEgbmV3IGNvbXBsYWludCwgcmVnYXJkbGVzcyBvZiB3aGV0aGVyIHRoZSBwYXRpZW50IGlzIGtub3duIG9yIHN1c3BlY3RlZCB0byBoYXZlIHNwZWNpZmljIGJlaGF2aW9yIHJpc2tzIGZvciBISVYgaW5mZWN0aW9uLicKCmRlZmluZSAiU2Vla2luZyBTVEQgVHJlYXRtZW50IEluZGljYXRvciI6CiAgIkluZm8iCgoKLyogUklTSyBMZXZlbCBBY3Rpb25zICovCmRlZmluZSAiUmlzayBMZXZlbCBDb25kaXRpb24iOgogICJJbiBQb3B1bGF0aW9uIgogIGFuZCAoCiAgICAiTmV2ZXIgVGVzdGVkIENvbmRpdGlvbiIgaXMgZmFsc2UKICAgIGFuZCAiTVNNIENvbmRpdGlvbiIgaXMgZmFsc2UKICAgIGFuZCAiUHJlZ25hbnQgQ29uZGl0aW9uIiBpcyBmYWxzZQogICAgYW5kICJTZWVraW5nIFNURCBUcmVhdG1lbnQgQ29uZGl0aW9uIiBpcyBmYWxzZQogICkKCmRlZmluZSAiUmlzayBMZXZlbCBSZWNvbW1lbmRhdGlvbiI6CiAgaWYgIlBhdGllbnQgaXMgYXQgSGlnaCBSaXNrIGZvciBISVYiIGFuZCAiT3ZlciAzIE1vbnRocyBoYXMgUGFzdCBTaW5jZSBQcmV2aW91cyBISVYgU2NyZWVuaW5nIiB0aGVuICdISVYgU2NyZWVuaW5nIFJlY29tbWVuZGVkIGR1ZSB0byBwYXRpZW50IGJlaW5nIGF0IEhpZ2ggUmlzayBmb3IgSElWIGFuZCBvdmVyIHRocmVlIG1vbnRocyBoYXZlIHBhc3NlZCBzaW5jZSBwcmV2aW91cyBzY3JlZW5pbmcuJwogIGVsc2UgaWYgIlBhdGllbnQgaXMgYXQgTW9kZXJhdGUgUmlzayBmb3IgSElWIiBhbmQgIk92ZXIgYSBZZWFyIGhhcyBQYXN0IFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciIHRoZW4gJ0hJViBTY3JlZW5pbmcgUmVjb21tZW5kZWQgZHVlIHRvIHBhdGllbnQgYmVpbmcgYXQgTW9kZXJhdGUgUmlzayBmb3IgSElWIGFuZCBvdmVyIGEgWWVhciBoYXMgcGFzc2VkIHNpbmNlIHByZXZpb3VzIHNjcmVlbmluZy4nCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBhdCBObyBSaXNrIGZvciBISVYiIHRoZW4gJ0hJViBTY3JlZW5pbmcgTm90IFJlY29tbWVuZGVkIGR1ZSB0byBwYXRpZW50IGJlaW5nIGF0IE5vIFJpc2sgZm9yIEhJVi4nCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBhdCBMb3cgUmlzayBmb3IgSElWIiB0aGVuICdISVYgU2NyZWVuaW5nIE5vdCBSZWNvbW1lbmRlZCBkdWUgdG8gcGF0aWVudCBiZWluZyBhdCBMb3cgUmlzayBmb3IgSElWLicKICBlbHNlICdISVYgU2NyZWVuaW5nIE5vdCBSZWNvbW1lbmRlZCBhdCB0aGlzIHRpbWUuIEl0IGhhcyBiZWVuICcgKyBUb1N0cmluZygiQW1vdW50IG9mIERheXMgU2luY2UgUHJldmlvdXMgSElWIFNjcmVlbmluZyIpICsgJyBkYXlzIHNpbmNlIGxhc3QgSElWIFNjcmVlbmluZy4nCgovKiBSaXNrIExldmVsIFJhdGlvbmFsIGJhc2VkIG9uIFJlY29tbWVuZGF0aW9uIE9wdGlvbiAoUmVmZXJlbmNlcyB0byBDREMgUmVjb21tZW5kYXRpb25zKSAqLwpkZWZpbmUgIlJpc2sgTGV2ZWwgUmF0aW9uYWxlIjoKICBpZiAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgZm9yIEhJViIgdGhlbiAnSGVhbHRoLWNhcmUgcHJvdmlkZXJzIHNob3VsZCBzdWJzZXF1ZW50bHkgdGVzdCBhbGwgcGVyc29ucyBsaWtlbHkgdG8gYmUgYXQgaGlnaCByaXNrIGZvciBISVYgYXQgbGVhc3QgZXZlcnkgMyBtb250aHMuIFBlcnNvbnMgbGlrZWx5IHRvIGJlIGF0IGhpZ2ggcmlzayBpbmNsdWRlIHBlcnNvbnMgd2l0aCBwcm9ibGVtcyByZWxhdGVkIHRvIGRydWcgYWJ1c2UsIGluamVjdGlvbi1kcnVnIHVzZXJzIGFuZCB0aGVpciBzZXggcGFydG5lcnMsIHBlcnNvbnMgd2hvIGV4Y2hhbmdlIHNleCBmb3IgbW9uZXkgb3IgZHJ1Z3MsIHNleCBwYXJ0bmVycyBvZiBISVYtaW5mZWN0ZWQgcGVyc29ucywgYW5kIE1TTSBvciBoZXRlcm9zZXh1YWwgcGVyc29ucyB3aG8gdGhlbXNlbHZlcyBvciB3aG9zZSBzZXggcGFydG5lcnMgaGF2ZSBoYWQgbW9yZSB0aGFuIG9uZSBzZXggcGFydG5lciBzaW5jZSB0aGVpciBtb3N0IHJlY2VudCBISVYgdGVzdC4nCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBhdCBNb2RlcmF0ZSBSaXNrIGZvciBISVYiIHRoZW4gJ0hlYWx0aC1jYXJlIHByb3ZpZGVycyBzaG91bGQgc3Vic2VxdWVudGx5IHRlc3QgYWxsIHBlcnNvbnMgbGlrZWx5IHRvIGJlIGF0IG1vZGVyYXRlIHJpc2sgZm9yIEhJViBhdCBsZWFzdCBhbm51YWxseS4gUGVyc29ucyBsaWtlbHkgdG8gYmUgYXQgbW9kZXJhdGUgcmlzayBpbmNsdWRlIE1TTSwgVHJhbnNnZW5kZXIgUGVyc29ucywgYW5kIEdheSBvciBCaXNleHVhbCBNZW4gd2hvIGFyZSBzZXh1YWxseSBhY3RpdmUgYW5kIGhhdmUgc2V4IHdpdGggb3RoZXIgbWVuLicKICBlbHNlIGlmICJQYXRpZW50IGlzIGF0IE5vIFJpc2sgZm9yIEhJViIgdGhlbiAnVGhlIFRhc2sgRm9yY2UgbWFkZSBubyByZWNvbW1lbmRhdGlvbiBmb3Igb3IgYWdhaW5zdCByb3V0aW5lbHkgc2NyZWVuaW5nIGFzeW1wdG9tYXRpYyBhZHVsdHMgYW5kIGFkb2xlc2NlbnRzIHdpdGggbm8gaWRlbnRpZmlhYmxlIHJpc2sgZmFjdG9ycyBmb3IgSElWLiBUaGUgVGFzayBGb3JjZSBjb25jbHVkZWQgdGhhdCBzdWNoIHNjcmVlbmluZyB3b3VsZCBkZXRlY3QgYWRkaXRpb25hbCBwYXRpZW50cyB3aXRoIEhJViwgYnV0IHRoZSBvdmVyYWxsIG51bWJlciB3b3VsZCBiZSBsaW1pdGVkLCBhbmQgdGhlIHBvdGVudGlhbCBiZW5lZml0cyBkaWQgbm90IGNsZWFybHkgb3V0d2VpZ2ggdGhlIGJ1cmRlbiBvbiBwcmltYXJ5IGNhcmUgcHJhY3RpY2VzIG9yIHRoZSBwb3RlbnRpYWwgaGFybXMgb2YgYSBnZW5lcmFsIEhJViBzY3JlZW5pbmcgcHJvZ3JhbS4nCiAgZWxzZSAnSW4gbG93IHByZXZhbGVuY2Ugc2V0dGluZ3MsIGluIHdoaWNoIHRoZSBtYWpvcml0eSBvZiBjbGllbnRzIGFyZSBhdCBtaW5pbWFsIHJpc2ssIHRhcmdldGVkIEhJViB0ZXN0aW5nIG9uIHRoZSBiYXNpcyBvZiByaXNrIHNjcmVlbmluZyB3YXMgY29uc2lkZXJlZCBtb3JlIGZlYXNpYmxlIGZvciBpZGVudGlmeWluZyBsaW1pdGVkIG51bWJlcnMgb2YgSElWLWluZmVjdGVkIHBlcnNvbnMuIFRoZSBUYXNrIEZvcmNlIGNvbmNsdWRlZCB0aGF0IHN1Y2ggc2NyZWVuaW5nIHdvdWxkIGRldGVjdCBhZGRpdGlvbmFsIHBhdGllbnRzIHdpdGggSElWLCBidXQgdGhlIG92ZXJhbGwgbnVtYmVyIHdvdWxkIGJlIGxpbWl0ZWQsIGFuZCB0aGUgcG90ZW50aWFsIGJlbmVmaXRzIGRpZCBub3QgY2xlYXJseSBvdXR3ZWlnaCB0aGUgYnVyZGVuIG9uIHByaW1hcnkgY2FyZSBwcmFjdGljZXMgb3IgdGhlIHBvdGVudGlhbCBoYXJtcyBvZiBhIGdlbmVyYWwgSElWIHNjcmVlbmluZyBwcm9ncmFtLicKCmRlZmluZSAiUmlzayBMZXZlbCBJbmRpY2F0b3IgU3RhdHVzIjoKICBpZiAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgZm9yIEhJViIgdGhlbiAiQ3JpdGljYWwiCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBhdCBNb2RlcmF0ZSBSaXNrIGZvciBISVYiIHRoZW4gIldhcm5pbmciCiAgZWxzZSBpZiAiUGF0aWVudCBpcyBhdCBObyBSaXNrIGZvciBISVYiIHRoZW4gIkluZm8iCiAgZWxzZSAiSW5mbyIKCmRlZmluZSAiRXhjbHVzaW9uIFJlYXNvbiI6CiAgaWYgIk1lZXRzIEV4Y2x1c2lvbiBDcml0ZXJpYSIgdGhlbgogICAgKAogICAgICAnUGF0aWVudCB3YXMgZXhjbHVkZWQgZnJvbSBISVYgU2NyZWVuaW5nICcKICAgICAgKyAoCiAgICAgICAgICBpZiBub3QgIlBhdGllbnQgaXMgYmV0d2VlbiAxMyBhbmQgNjQgeWVhcnMgb2xkIiB0aGVuICdkdWUgdG8gbm90IGJlaW5nIGJldHdlZW4gdGhlIGFnZXMgb2YgMTMgYW5kIDY0LicKICAgICAgICAgIGVsc2UgaWYgIkFjdGl2ZSBEaWFnbm9zaXMgb2YgSElWIER1cmluZyBQYXRpZW50IFZpc2l0IiBpcyBub3QgbnVsbCB0aGVuICdkdWUgdG8gdGhlIHBhdGllbnQgYWxyZWFkeSBoYXZpbmcgYmVlbiBkaWFnbm9zZWQgd2l0aCBISVYuJwogICAgICAgICAgZWxzZSAnJwogICAgICAgICkKICAgICkKICBlbHNlICcnCgoKLyogSElWIFNjcmVlbmluZyBXb3JrZmxvdyAqLwovLyBQYXRpZW50IFZpc2l0IE9jY3VycmVkCmRlZmluZSAiUGF0aWVudCBFbmNvdW50ZXIiOgogIExhc3QoCiAgICAoSEMuUXVhbGlmaWVkRW5jb3VudGVycygKICAgICAgSERFLiJQYXRpZW50IEVuY291bnRlciIKICAgICAgdW5pb24gSERFLiJQcmVnbmFuY3kgRW5jb3VudGVycyIKICAgICAgdW5pb24gSERFLiJUaGlyZCBUcmltZXN0ZXIgRW5jb3VudGVycyIKICAgICkpIFBhdGllbnRFbmNvdW50ZXIKICAgIHNvcnQgYnkgZW5kIG9mIHBlcmlvZCkKCgovKiBEZXRlcm1pbmUgUGF0aWVudCBDaGFyYWN0ZXJpc3RpY3MgYW5kIFRlc3RpbmcgQ3JpdGVyaWEgKi8KZGVmaW5lICJQYXRpZW50IGlzIGJldHdlZW4gMTMgYW5kIDY0IHllYXJzIG9sZCI6CiAgQWdlSW5ZZWFyc0F0KGVuZCBvZiAiUGF0aWVudCBFbmNvdW50ZXIiLnBlcmlvZCkgPj0gMTMKICBhbmQgQWdlSW5ZZWFyc0F0KGVuZCBvZiAiUGF0aWVudCBFbmNvdW50ZXIiLnBlcmlvZCkgPD0gNjQKCmRlZmluZSAiQWN0aXZlIERpYWdub3NpcyBvZiBISVYgRHVyaW5nIFBhdGllbnQgVmlzaXQiOgogIChMYXN0KAogICAgKEhDLlF1YWxpZmllZENvbmRpdGlvbnMoSERFLiJISVYgRGlhZ25vc2lzIikpIEhJVkRpYWdub3NpcwogICAgICBzb3J0IGJ5IGVuZCBvZiBGQy5Ub0ludGVydmFsKGFiYXRlbWVudCkKICApKSBISVZEaWFnbm9zaXMKICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgIHN1Y2ggdGhhdCBGQy5Ub1ByZXZhbGVuY2VJbnRlcnZhbChISVZEaWFnbm9zaXMpIG92ZXJsYXBzIFBhdGllbnRFbmNvdW50ZXIucGVyaW9kCgpkZWZpbmUgIkhJViBTY3JlZW5pbmcgVGVzdCI6CiAgKAogICAgSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iSElWIFRlc3QiKQogICAgdW5pb24gSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iUHJldmlvdXMgSElWIFNjcmVlbmluZyIpCiAgKSBISVZTY3JlZW5pbmcKICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgIHN1Y2ggdGhhdCBGQy5Ub0ludGVydmFsKEhJVlNjcmVlbmluZy5lZmZlY3RpdmUpIGJlZm9yZSBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAoKZGVmaW5lICJQYXRpZW50IGhhcyBoYWQgYW4gSElWIFNjcmVlbmluZyI6CiAgZXhpc3RzKCJISVYgU2NyZWVuaW5nIFRlc3QiKQoKZGVmaW5lICJQcmV2aW91cyBISVYgU2NyZWVuaW5nIFRlc3QiOgogIGZyb20KICAoCiAgICBMYXN0KCJISVYgU2NyZWVuaW5nIFRlc3QiIEhJVlRlc3QKICAgICAgc29ydCBieSBlbmQgb2YgRkMuVG9JbnRlcnZhbChlZmZlY3RpdmUpKQogICkgTW9zdFJlY2VudEhJVlRlc3QsCiAgIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICB3aGVyZSBGQy5Ub0ludGVydmFsKE1vc3RSZWNlbnRISVZUZXN0LmVmZmVjdGl2ZSkgYmVmb3JlIFBhdGllbnRFbmNvdW50ZXIucGVyaW9kCgpkZWZpbmUgIkFtb3VudCBvZiBEYXlzIFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciOgogICJQcmV2aW91cyBISVYgU2NyZWVuaW5nIFRlc3QiIEhJVlRlc3QKICAgIHJldHVybiBkdXJhdGlvbiBpbiBkYXlzIGJldHdlZW4gZW5kIG9mIEZDLlRvSW50ZXJ2YWwoSElWVGVzdC5Nb3N0UmVjZW50SElWVGVzdC5lZmZlY3RpdmUpIGFuZCBlbmQgb2YgSElWVGVzdC5QYXRpZW50RW5jb3VudGVyLnBlcmlvZAoKZGVmaW5lICJPdmVyIGEgWWVhciBoYXMgUGFzdCBTaW5jZSBQcmV2aW91cyBISVYgU2NyZWVuaW5nIjoKICAiUHJldmlvdXMgSElWIFNjcmVlbmluZyBUZXN0IiBISVZUZXN0CiAgICByZXR1cm4gKGR1cmF0aW9uIGluIHllYXJzIGJldHdlZW4gZW5kIG9mIEZDLlRvSW50ZXJ2YWwoSElWVGVzdC5Nb3N0UmVjZW50SElWVGVzdC5lZmZlY3RpdmUpIGFuZCBlbmQgb2YgSElWVGVzdC5QYXRpZW50RW5jb3VudGVyLnBlcmlvZCkgPj0gMQoKZGVmaW5lICJPdmVyIDMgTW9udGhzIGhhcyBQYXN0IFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciOgogICJQcmV2aW91cyBISVYgU2NyZWVuaW5nIFRlc3QiIEhJVlRlc3QKICAgIHJldHVybiAoZHVyYXRpb24gaW4gbW9udGhzIGJldHdlZW4gZW5kIG9mIEZDLlRvSW50ZXJ2YWwoSElWVGVzdC5Nb3N0UmVjZW50SElWVGVzdC5lZmZlY3RpdmUpIGFuZCBlbmQgb2YgSElWVGVzdC5QYXRpZW50RW5jb3VudGVyLnBlcmlvZCkgPj0gMwoKZGVmaW5lICJQYXRpZW50IGhhcyBSZWNlaXZlZCBQcmUgRXhwb3N1cmUgUHJvcGh5bGF4aXMiOgogIGV4aXN0cygKICAgIEhDLlF1YWxpZmllZE1lZGljYXRpb25SZXF1ZXN0cyhIREUuIlByZSBFeHBvc3VyZSBQcm9waHlsYXhpcyBNZWRpY2F0aW9uIFByZXNjcmlwdGlvbnMiKQogICAgdW5pb24gSEMuUXVhbGlmaWVkTWVkaWNhdGlvbkRpc3BlbnNlcyhIREUuIlByZSBFeHBvc3VyZSBQcm9waHlsYXhpcyBEaXNwZW5zZWQgTWVkaWNhdGlvbnMiKQogICAgdW5pb24gSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iUHJldmlvdXMgZXhwZXJpZW5jZSB3aXRoIFBSRVAiKQogICkgUHJFUAoKCi8qIERldGVybWluZSBQYXRpZW50J3MgQ2F0ZWdvcnkgKGdlbmRlciwgcHJlZ25hbmN5LCBNU00sIHNleHVhbCBhY3Rpdml0eSwgZXRjKSAqLwpkZWZpbmUgIlBhdGllbnQgaXMgTWFsZSI6CiAgaWYgUGF0aWVudC5nZW5kZXIgPSAnbWFsZScgdGhlbiB0cnVlIGVsc2UgZmFsc2UKCmRlZmluZSAiUGF0aWVudCBpcyBGZW1hbGUiOgogIGlmIFBhdGllbnQuZ2VuZGVyID0gJ2ZlbWFsZScgdGhlbiB0cnVlIGVsc2UgZmFsc2UKCmRlZmluZSAiUGF0aWVudCBHZW5kZXIgSWRlbnRpdHkiOgogICgKICAgICgKICAgICAgZmxhdHRlbgogICAgICAoCiAgICAgICAgKEhERS4iR2VuZGVyIElkZW50aXR5IikgR2VuZGVySWRlbnRpdHkKICAgICAgICAgIHJldHVybiBHZW5kZXJJZGVudGl0eS5leHRlbnNpb24KICAgICAgKQogICAgKSBFCiAgICB3aGVyZSBFLnVybCA9ICdHZW5kZXIgSWRlbnRpdHknCiAgKSBFCiAgICByZXR1cm4gRS52YWx1ZSBhcyBDb2RlYWJsZUNvbmNlcHQKCmRlZmluZSAiUGF0aWVudCBTZXh1YWwgT3JpZW50YXRpb24iOgogICgKICAgICgKICAgICAgZmxhdHRlbgogICAgICAoCiAgICAgICAgKEhERS4iU2V4dWFsIE9yaWVudGF0aW9uIikgU2V4dWFsT3JpZW50YXRpb24KICAgICAgICAgIHJldHVybiBTZXh1YWxPcmllbnRhdGlvbi5leHRlbnNpb24KICAgICAgKQogICAgKSBFCiAgICB3aGVyZSBFLnVybCA9ICdTZXh1YWwgT3JpZW50YXRpb24nCiAgKSBFCiAgICByZXR1cm4gRS52YWx1ZSBhcyBDb2RlYWJsZUNvbmNlcHQKCmRlZmluZSAiUGF0aWVudCBpcyBUcmFuc2dlbmRlciI6CiAgZXhpc3RzICgKICAgICJQYXRpZW50IEdlbmRlciBJZGVudGl0eSIgR2VuZGVySWRlbnRpdHkKICAgICAgd2hlcmUgR2VuZGVySWRlbnRpdHkgaW4gQ3guIlRyYW5zZ2VuZGVyIgogICkKCmRlZmluZSAiUGF0aWVudCBpcyBHYXkgb3IgQmlzZXh1YWwiOgogIGV4aXN0cyAoCiAgICAgICJQYXRpZW50IFNleHVhbCBPcmllbnRhdGlvbiIgU2V4dWFsT3JpZW50YXRpb24KICAgICAgICB3aGVyZSBTZXh1YWxPcmllbnRhdGlvbiBpbiBDeC4iR2F5IE9yIEJpc2V4dWFsIgogICkKCmRlZmluZSAiUGF0aWVudCBpcyBQcmVnbmFudCI6CiAgZXhpc3RzKAogICAgKEhDLlF1YWxpZmllZENvbmRpdGlvbnMoSERFLiJQcmVnbmFuY3kgQ29uZGl0aW9ucyIpKSBQcmVnbmFuY3kKICAgICAgd2l0aCAiUGF0aWVudCBFbmNvdW50ZXIiIFBhdGllbnRFbmNvdW50ZXIKICAgICAgICBzdWNoIHRoYXQgRkMuVG9QcmV2YWxlbmNlSW50ZXJ2YWwoUHJlZ25hbmN5KSBvdmVybGFwcyBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAogICkKCgovKiBEZXRlcm1pbmUgUGF0aWVudCdzIFJpc2sgTGV2ZWwgKEhpZ2ggUmlzaywgTm9ybWFsIFJpc2ssIE5vIFJpc2ssIExvdyBSaXNrKSAqLwovLyBQcmVkb21pbmFudGx5IGJhc2VkIG9mZiBlbGVtZW50cyBidWlsdCBmcm9tIHRoZSByaXNrLWZhY3RvcnMgcXVlc3Rpb25uYWlyZQovLyBSSVNLUzogU1RJcywgSW5qZWN0aW9uIERydWcgVXNlLCBTZXggcGFydG5lciBoYXMgSElWLCBTZXggRXhjaGFuZ2VkIGZvciBEcnVncy9Nb25leSwgTW9yZSB0aGFuIDEgUGFydG5lciBzaW5jZSBwcmV2aW91cyBzY3JlZW5pbmcgKGZvciB0aGVtc2VsdmVzIG9yIHRoZWlyIHBhcnRuZXJzKSwgRHJ1ZyBhYnVzZQoKLyogMS4gUmVjb21tZW5kIFNjcmVlbmluZyAzIG1vbnRocyAoSGlnaCBSaXNrIC0gQ0RDIFJpc2sgRmFjdG9ycykKICAgIDIuIFJlY29tbWVuZCBTY3JlZW5pbmcgQW5udWFsbHkgKE1vZGVyYXRlIFJpc2sgLSBTT0dJIFJpc2sgRmFjdG9ycykKICAgIDMuIE5vIFJlY29tbWVuZGF0aW9uIFNjcmVlbmluZyAoTm8gUmlzaykgLyBMb3cgUmlzawogICAgNC4gUmVjb21tZW5kIFNjcmVlbmluZyBDdXN0b20gUGVyaW9kcyAoMyBtb250aHMgYmFzZWQgb24gc3BlY2lmaWMgcmlzayBmYWN0b3IgLS0gc2V4dWFsbHkgYWN0aXZlIE1TTSB3LyBwcmVwLCBldGMpCiAgICAgIC8vIE1TTSAvIFByZWduYW5jeSAvIENEQyBSZWNvbW1lbmRhdGlvbgoqLwoKLyogSElHSCBSSVNLICovCi8vIEhpZ2ggUmlzayAtLSBPdGhlciBTVElzCmRlZmluZSAiQWN0aXZlIERpYWdub3NpcyBvZiBIQ1YgRHVyaW5nIFBhdGllbnQgVmlzaXQiOgogICgKICAgIChMYXN0KAogICAgICAoSEMuUXVhbGlmaWVkQ29uZGl0aW9ucyhIREUuIkhlcGF0aXRpcyBDIERpYWdub3NpcyIpKSBIQ1ZEaWFnbm9zaXMKICAgICAgICBzb3J0IGJ5IGVuZCBvZiBGQy5Ub0ludGVydmFsKGFiYXRlbWVudCkpCiAgICApIEhDVkRpYWdub3NpcwogICAgd2l0aCAiUGF0aWVudCBFbmNvdW50ZXIiIFBhdGllbnRFbmNvdW50ZXIKICAgICAgc3VjaCB0aGF0IEZDLlRvUHJldmFsZW5jZUludGVydmFsKEhDVkRpYWdub3Npcykgb3ZlcmxhcHMgUGF0aWVudEVuY291bnRlci5wZXJpb2QKICApIGlzIG5vdCBudWxsCiAgb3IgZXhpc3RzKAogICAgKEhDLlF1YWxpZmllZE9ic2VydmF0aW9ucyhIREUuIlBhdGllbnQgRGlhZ25vc2VkIHdpdGggSENWIikpIEhDVk9ic2VydmVkCiAgICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgICAgc3VjaCB0aGF0IEZDLlRvSW50ZXJ2YWwoSENWT2JzZXJ2ZWQuZWZmZWN0aXZlKSBvdmVybGFwcyBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAogICkKCmRlZmluZSAiQWN0aXZlIERpYWdub3NpcyBvZiBTeXBoaWxpcyBEdXJpbmcgUGF0aWVudCBWaXNpdCI6CiAgKAogICAgKExhc3QoCiAgICAgIChIQy5RdWFsaWZpZWRDb25kaXRpb25zKEhERS4iU3lwaGlsaXMgRGlhZ25vc2lzIikpIFN5cGhpbGlzRGlhZ25vc2lzCiAgICAgICAgc29ydCBieSBlbmQgb2YgRkMuVG9JbnRlcnZhbChhYmF0ZW1lbnQpKQogICAgKSBTeXBoaWxpc0RpYWdub3NpcwogICAgd2l0aCAiUGF0aWVudCBFbmNvdW50ZXIiIFBhdGllbnRFbmNvdW50ZXIKICAgICAgc3VjaCB0aGF0IEZDLlRvUHJldmFsZW5jZUludGVydmFsKFN5cGhpbGlzRGlhZ25vc2lzKSBvdmVybGFwcyBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAogICkgaXMgbm90IG51bGwKICBvciBleGlzdHMoCiAgICAoSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iUGF0aWVudCBEaWFnbm9zZWQgd2l0aCBTeXBoaWxpcyIpKSBTeXBoaWxpc09ic2VydmVkCiAgICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgICAgc3VjaCB0aGF0IEZDLlRvSW50ZXJ2YWwoU3lwaGlsaXNPYnNlcnZlZC5lZmZlY3RpdmUpIG92ZXJsYXBzIFBhdGllbnRFbmNvdW50ZXIucGVyaW9kCiAgKQoKZGVmaW5lICJBY3RpdmUgRGlhZ25vc2lzIG9mIEdvbm9ycmhlYSBEdXJpbmcgUGF0aWVudCBWaXNpdCI6CiAgKAogICAgKExhc3QoCiAgICAgIChIQy5RdWFsaWZpZWRDb25kaXRpb25zKEhERS4iR29ub3JyaGVhIERpYWdub3NpcyIpKSBHb25vcnJoZWFEaWFnbm9zaXMKICAgICAgICBzb3J0IGJ5IGVuZCBvZiBGQy5Ub0ludGVydmFsKGFiYXRlbWVudCkpCiAgICApIEdvbm9ycmhlYURpYWdub3NpcwogICAgd2l0aCAiUGF0aWVudCBFbmNvdW50ZXIiIFBhdGllbnRFbmNvdW50ZXIKICAgICAgc3VjaCB0aGF0IEZDLlRvUHJldmFsZW5jZUludGVydmFsKEdvbm9ycmhlYURpYWdub3Npcykgb3ZlcmxhcHMgUGF0aWVudEVuY291bnRlci5wZXJpb2QKICApIGlzIG5vdCBudWxsCiAgb3IgZXhpc3RzKAogICAgKEhDLlF1YWxpZmllZE9ic2VydmF0aW9ucyhIREUuIlBhdGllbnQgRGlhZ25vc2VkIHdpdGggR29ub3JyaGVhIikpIEdvbm9ycmhlYU9ic2VydmVkCiAgICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgICAgc3VjaCB0aGF0IEZDLlRvSW50ZXJ2YWwoR29ub3JyaGVhT2JzZXJ2ZWQuZWZmZWN0aXZlKSBvdmVybGFwcyBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAogICkKCmRlZmluZSAiQWN0aXZlIERpYWdub3NpcyBvZiBDaGxhbXlkaWEgRHVyaW5nIFBhdGllbnQgVmlzaXQiOgogICgKICAgIChMYXN0KAogICAgICAoSEMuUXVhbGlmaWVkQ29uZGl0aW9ucyhIREUuIkNobGFteWRpYSBEaWFnbm9zaXMiKSkgQ2hsYW15ZGlhRGlhZ25vc2lzCiAgICAgICAgc29ydCBieSBlbmQgb2YgRkMuVG9JbnRlcnZhbChhYmF0ZW1lbnQpKQogICAgKSBDaGxhbXlkaWFEaWFnbm9zaXMKICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgIHN1Y2ggdGhhdCBGQy5Ub1ByZXZhbGVuY2VJbnRlcnZhbChDaGxhbXlkaWFEaWFnbm9zaXMpIG92ZXJsYXBzIFBhdGllbnRFbmNvdW50ZXIucGVyaW9kCiAgKSBpcyBub3QgbnVsbAogIG9yIGV4aXN0cygKICAgIChIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJQYXRpZW50IERpYWdub3NlZCB3aXRoIENobGFteWRpYSIpKSBDaGxhbXlkaWFPYnNlcnZlZAogICAgICB3aXRoICJQYXRpZW50IEVuY291bnRlciIgUGF0aWVudEVuY291bnRlcgogICAgICAgIHN1Y2ggdGhhdCBGQy5Ub0ludGVydmFsKENobGFteWRpYU9ic2VydmVkLmVmZmVjdGl2ZSkgb3ZlcmxhcHMgUGF0aWVudEVuY291bnRlci5wZXJpb2QKICApCgpkZWZpbmUgIlBhdGllbnQgaXMgYXQgSGlnaCBSaXNrIER1ZSB0byBhIFNURCI6CiAgIkFjdGl2ZSBEaWFnbm9zaXMgb2YgSENWIER1cmluZyBQYXRpZW50IFZpc2l0IgogIG9yICJBY3RpdmUgRGlhZ25vc2lzIG9mIFN5cGhpbGlzIER1cmluZyBQYXRpZW50IFZpc2l0IgogIG9yICJBY3RpdmUgRGlhZ25vc2lzIG9mIEdvbm9ycmhlYSBEdXJpbmcgUGF0aWVudCBWaXNpdCIKICBvciAiQWN0aXZlIERpYWdub3NpcyBvZiBDaGxhbXlkaWEgRHVyaW5nIFBhdGllbnQgVmlzaXQiCgovLyBIaWdoIFJpc2sgLS0gSW5qZWN0aW9uIERydWcgVXNlCi8vIE5PVEU6IFdoYXQgaXMgY29uc2lkZXJlZCBhbiBBY3RpdmUgVGltZSBQZXJpb2QgZm9yIEluamVjdGlvbiBEcnVnIFVzZT8KZGVmaW5lICJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBEdWUgdG8gSW5qZWN0aW9uIERydWcgVXNlIjoKICAoCiAgICAoTGFzdCgKICAgICAgKAogICAgICAgIEhDLlF1YWxpZmllZFByb2NlZHVyZXMoSERFLiJEcnVnIFJlaGFiaWxpdGF0aW9uIikKICAgICAgICB1bmlvbiBIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJJbmplY3Rpb24gRmluZGluZ3MiKQogICAgICAgIHVuaW9uIEhDLlF1YWxpZmllZENvbmRpdGlvbnMoSERFLiJJbmplY3Rpb24gRHJ1ZyBVc2UgRGlhZ25vc2lzIikKICAgICAgICB1bmlvbiBIQy5RdWFsaWZpZWRNZWRpY2F0aW9uU3RhdGVtZW50cyhIREUuIkluamVjdGlvbiBEcnVnIFVzZSIpCiAgICAgICAgdW5pb24gSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iUGF0aWVudCBoYXMgdXNlZCBJbmplY3Rpb24gRHJ1Z3MiKQogICAgICApIEluamVjdGlvbkRydWdVc2UKICAgICAgICAgIHJldHVybiBUdXBsZSB7CiAgICAgICAgICAgIHJlc291cmNlOiBJbmplY3Rpb25EcnVnVXNlLAogICAgICAgICAgICBJRFVUaW1pbmc6IENvYWxlc2NlKAogICAgICAgICAgICAgIGVuZCBvZiBGQy5Ub0ludGVydmFsKEluamVjdGlvbkRydWdVc2UucGVyZm9ybWVkKSwgZW5kIG9mIEZDLlRvSW50ZXJ2YWwoSW5qZWN0aW9uRHJ1Z1VzZS5lZmZlY3RpdmUpLCBlbmQgb2YgRkMuVG9QcmV2YWxlbmNlSW50ZXJ2YWwoSW5qZWN0aW9uRHJ1Z1VzZSkKICAgICAgICAgICAgKSB9IHNvcnQgYnkgSURVVGltaW5nKS5yZXNvdXJjZQogICAgKSBJbmplY3Rpb25EcnVnVXNlCiAgICB3aXRoICJQYXRpZW50IEVuY291bnRlciIgUGF0aWVudEVuY291bnRlcgogICAgICBzdWNoIHRoYXQgQ29hbGVzY2UoRkMuVG9JbnRlcnZhbChJbmplY3Rpb25EcnVnVXNlLnBlcmZvcm1lZCksIEZDLlRvSW50ZXJ2YWwoSW5qZWN0aW9uRHJ1Z1VzZS5lZmZlY3RpdmUpLCBGQy5Ub1ByZXZhbGVuY2VJbnRlcnZhbChJbmplY3Rpb25EcnVnVXNlKSkgb3ZlcmxhcHMgUGF0aWVudEVuY291bnRlci5wZXJpb2QKICApIGlzIG5vdCBudWxsCgovL0hpZ2ggUmlzayAtLSBEcnVnIEFidXNlCmRlZmluZSAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgRHVlIHRvIERydWcgQWJ1c2UiOgogICJQYXRpZW50IEhhcyBIaWdoIERlZ3JlZSBPZiBQcm9ibGVtcyBSZWxhdGVkIFRvIERydWcgQWJ1c2UiCgovLyBIaWdoIFJpc2sgLS0gUGFydG5lciB3aXRoIEhJVgpkZWZpbmUgIlBhdGllbnQgaXMgYXQgSGlnaCBSaXNrIER1ZSB0byBTZXh1YWwgUGFydG5lciBoYXZpbmcgSElWIjoKICBleGlzdHMoCiAgICAoSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iU2V4dWFsIEFjdGl2aXR5IC0gUGFydG5lcnMgSElWIEhpc3RvcnkiKSkgSElWUGFydG5lckhpc3RvcnkKICAgICAgd2l0aCAiUGF0aWVudCBFbmNvdW50ZXIiIFBhdGllbnRFbmNvdW50ZXIKICAgICAgICBzdWNoIHRoYXQgRkMuVG9JbnRlcnZhbChISVZQYXJ0bmVySGlzdG9yeS5lZmZlY3RpdmUpIG92ZXJsYXBzIFBhdGllbnRFbmNvdW50ZXIucGVyaW9kCiAgKQoKLy8gSGlnaCBSaXNrIC0tIFNleCBFeGNoYW5nZWQgZm9yIERydWdzL01vbmV5CmRlZmluZSAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgRHVlIHRvIGV4Y2hhbmdpbmcgc2V4IGZvciBtb25leSBhbmQvb3IgZHJ1Z3MiOgogIGV4aXN0cygKICAgIChIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJTZXh1YWwgQWN0aXZpdHkgLSBFeGNoYW5nZWQgZm9yIFNleCIpKSBTZXhFeGNoYW5nZWQKICAgICAgd2l0aCAiUGF0aWVudCBFbmNvdW50ZXIiIFBhdGllbnRFbmNvdW50ZXIKICAgICAgICBzdWNoIHRoYXQgRkMuVG9JbnRlcnZhbChTZXhFeGNoYW5nZWQuZWZmZWN0aXZlKSBvdmVybGFwcyBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAogICkKCi8vIEhpZ2ggUmlzayAtLSBNdWx0aXBsZSBTZXggUGFydG5lcnMgc2luY2UgcHJldmlvdXMgSElWIFNjcmVlbmluZyBmb3IgUGF0aWVudCBvciB0aGVpciBwYXJ0bmVyCmRlZmluZSAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgRHVlIHRvIE11bHRpcGxlIFNleCBQYXJ0bmVycyBzaW5jZSBsYXN0IHNjcmVlbmluZyI6CiAgKAogICAgKExhc3QoCiAgICAgICgKICAgICAgICBIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJISVYgVGVzdCIpCiAgICAgICAgdW5pb24gSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iUHJldmlvdXMgSElWIFNjcmVlbmluZyIpCiAgICAgICkgSElWU2NyZWVuaW5nCiAgICAgIHNvcnQgYnkgZW5kIG9mIEZDLlRvSW50ZXJ2YWwoZWZmZWN0aXZlKQogICkpIEhJVlNjcmVlbmluZwogICAgd2l0aCAoCiAgICAgIEhDLlF1YWxpZmllZE9ic2VydmF0aW9ucyhIREUuIlNleHVhbCBBY3Rpdml0eSAtIE51bWJlciBvZiBQYXJ0bmVycyIpCiAgICAgIHVuaW9uIEhDLlF1YWxpZmllZE9ic2VydmF0aW9ucyhIREUuIlNleHVhbCBBY3Rpdml0eSAtIFBhcnRuZXJzIE51bWJlciBvZiBQYXJ0bmVycyIpCiAgICApIE51bWJlck9mUGFydG5lcnMKICAgICAgc3VjaCB0aGF0IEZDLlRvSW50ZXJ2YWwoSElWU2NyZWVuaW5nLmVmZmVjdGl2ZSkgYmVmb3JlIEZDLlRvSW50ZXJ2YWwoTnVtYmVyT2ZQYXJ0bmVycy5lZmZlY3RpdmUpCiAgKSBpcyBub3QgbnVsbAoKZGVmaW5lICJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBmb3IgSElWIjoKICAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgRHVlIHRvIGEgU1REIgogIG9yICJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBEdWUgdG8gSW5qZWN0aW9uIERydWcgVXNlIgogIG9yICJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBEdWUgdG8gRHJ1ZyBBYnVzZSIKICBvciAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgRHVlIHRvIFNleHVhbCBQYXJ0bmVyIGhhdmluZyBISVYiCiAgb3IgIlBhdGllbnQgaXMgYXQgSGlnaCBSaXNrIER1ZSB0byBleGNoYW5naW5nIHNleCBmb3IgbW9uZXkgYW5kL29yIGRydWdzIgogIG9yICJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBEdWUgdG8gTXVsdGlwbGUgU2V4IFBhcnRuZXJzIHNpbmNlIGxhc3Qgc2NyZWVuaW5nIgoKCi8qIE1PREVSQVRFIFJJU0sgKi8KLy8gU2V4dWFsbHkgYWN0aXZlIE1TTSwgVHJhbnNnZW5kZXIgcGF0aWVudCBzZXh1YWxseSBhY3RpdmUgd2l0aCBtZW4sIEdheSBhbmQgYmlzZXh1YWwgbWVuIHVubGVzcyBkb2N1bWVudGVkIG5vdCBzZXh1YWxseSBhY3RpdmUKCi8vIE1vZGVyYXRlIFJpc2sgLS0gQW55IHNleHVhbGx5IGFjdGl2ZSBNU00KZGVmaW5lICJTZXh1YWxseSBBY3RpdmUgTVNNIFBhdGllbnQiOgogIGlmICJQYXRpZW50IGlzIE1hbGUiIHRoZW4KICAgICgKICAgICAgZXhpc3RzKAogICAgICAgIChIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJTZXh1YWwgQWN0aXZpdHkgLSBNZW4iKSkgTVNNT2JzZXJ2ZWQKICAgICAgICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgICAgICAgIHN1Y2ggdGhhdCBGQy5Ub0ludGVydmFsKE1TTU9ic2VydmVkLmVmZmVjdGl2ZSkgb3ZlcmxhcHMgUGF0aWVudEVuY291bnRlci5wZXJpb2QKICAgICAgKQogICAgKQogIGVsc2UgZmFsc2UKCi8vIE1vZGVyYXRlIFJpc2sgLS0gVHJhbnNnZW5kZXIgcGF0aWVudHMgc2V4dWFsbHkgYWN0aXZlIHdpdGggbWVuCmRlZmluZSAiVHJhbnNnZW5kZXIgUGF0aWVudCBTZXh1YWxseSBBY3RpdmUgV2l0aCBNZW4iOgogIGlmICJQYXRpZW50IGlzIFRyYW5zZ2VuZGVyIiB0aGVuCiAgICAoCiAgICAgIGV4aXN0cygKICAgICAgICAoSEMuUXVhbGlmaWVkT2JzZXJ2YXRpb25zKEhERS4iU2V4dWFsIEFjdGl2aXR5IC0gTWVuIikpIE1TTU9ic2VydmVkCiAgICAgICAgICB3aXRoICJQYXRpZW50IEVuY291bnRlciIgUGF0aWVudEVuY291bnRlcgogICAgICAgICAgICBzdWNoIHRoYXQgRkMuVG9JbnRlcnZhbChNU01PYnNlcnZlZC5lZmZlY3RpdmUpIG92ZXJsYXBzIFBhdGllbnRFbmNvdW50ZXIucGVyaW9kCiAgICAgICkKICAgICkKICBlbHNlIGZhbHNlCgovLyBNb2RlcmF0ZSBSaXNrIC0tIEFsbCBnYXkgb3IgYmlzZXh1YWwgbWVuIHVubGVzcyBkb2N1bWVudGVkIG5vdCBzZXh1YWxseSBhY3RpdmUKZGVmaW5lICJNYWxlLCBHYXksIG9yIEJpc2V4dWFsIFBhdGllbnQgTm90IERvY3VtZW50ZWQgU2V4dWFsbHkgSW5hY3RpdmUiOgogICJQYXRpZW50IGlzIE1hbGUiIGFuZCAiUGF0aWVudCBpcyBHYXkgb3IgQmlzZXh1YWwiIGFuZCBub3QgIlBhdGllbnQgaXMgbm90IFNleHVhbGx5IEFjdGl2ZSIKCmRlZmluZSAiUGF0aWVudCBpcyBhdCBNb2RlcmF0ZSBSaXNrIGZvciBISVYiOgogICJTZXh1YWxseSBBY3RpdmUgTVNNIFBhdGllbnQiCiAgb3IgIlRyYW5zZ2VuZGVyIFBhdGllbnQgU2V4dWFsbHkgQWN0aXZlIFdpdGggTWVuIgogIG9yICJNYWxlLCBHYXksIG9yIEJpc2V4dWFsIFBhdGllbnQgTm90IERvY3VtZW50ZWQgU2V4dWFsbHkgSW5hY3RpdmUiCgoKLyogTm8gUmlzayAqLwovLyBOb3QgU2V4dWFsbHkgQWN0aXZlCmRlZmluZSAiUGF0aWVudCBpcyBub3QgU2V4dWFsbHkgQWN0aXZlIjoKICAoCiAgICAoCiAgICAgIExhc3QKICAgICAgKAogICAgICAgICgKICAgICAgICAgIEhDLlF1YWxpZmllZE9ic2VydmF0aW9ucyhIREUuIlNleHVhbCBBY3Rpdml0eSAtIFBhc3QgWWVhciIpCiAgICAgICAgICB1bmlvbiBIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJTZXh1YWwgQWN0aXZpdHkgLSBIaXN0b3J5IikKICAgICAgICAgIHVuaW9uIEhDLlF1YWxpZmllZE9ic2VydmF0aW9ucyhIREUuIlNleHVhbCBBY3Rpdml0eSAtIE1lbiIpCiAgICAgICAgICB1bmlvbiBIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJTZXh1YWwgQWN0aXZpdHkgLSBXb21lbiIpCgogICAgICAgICkgU2V4dWFsSGlzdG9yeQogICAgICAgICAgICB3aGVyZSBDb2FsZXNjZShMb3dlcihTZXh1YWxIaXN0b3J5LnZhbHVlIGFzIHN0cmluZykgaW4geyAnbm8nIH0sIFNleHVhbEhpc3RvcnkudmFsdWUgYXMgYm9vbGVhbiA9IGZhbHNlKQogICAgICAgICAgICAgIHNvcnQgYnkgQ29hbGVzY2UoZWZmZWN0aXZlLCBpc3N1ZWQpCiAgICAgICkKICAgICkgU2V4dWFsSGlzdG9yeQogICAgICB3aXRoICJQYXRpZW50IEVuY291bnRlciIgRW5jb3VudGVyCiAgICAgICAgc3VjaCB0aGF0IENvYWxlc2NlKEZDLlRvSW50ZXJ2YWwoU2V4dWFsSGlzdG9yeS5lZmZlY3RpdmUpLCBGQy5Ub0ludGVydmFsKFNleHVhbEhpc3RvcnkuaXNzdWVkKSkgZHVyaW5nIEVuY291bnRlci5wZXJpb2QKICApIGlzIG5vdCBudWxsCgpkZWZpbmUgIlBhdGllbnQgaXMgYXQgTm8gUmlzayBmb3IgSElWIjoKICAiUGF0aWVudCBpcyBub3QgU2V4dWFsbHkgQWN0aXZlIgoKCi8qIExPVyBSSVNLICovCi8vIE5vdCBzZXh1YWxseSBhY3RpdmUKZGVmaW5lICJQYXRpZW50IGlzIGF0IExvdyBSaXNrIGZvciBISVYiOgogIG5vdCAiUGF0aWVudCBpcyBhdCBIaWdoIFJpc2sgZm9yIEhJViIKICBhbmQgbm90ICJQYXRpZW50IGlzIGF0IE1vZGVyYXRlIFJpc2sgZm9yIEhJViIKICBhbmQgbm90ICJQYXRpZW50IGlzIGF0IE5vIFJpc2sgZm9yIEhJViIKCgovKiBXb21lbiAmIE1lbiBXb3JrZmxvdyAqLwovLyBBbGwgV29tZW4gYW5kIE1lbiBiZXR3ZWVuIHRoZSBhZ2VzIDEzLTY0IGFuZC9vciB0aG9zZSB3aG8gYXJlIHNlZWtpbmcgdHJlYXRtZW50IGZvciBhbiBTVEQKZGVmaW5lICJQYXRpZW50IGlzIFNlZWtpbmcgVHJlYXRtZW50IGZvciBhbiBTVEQiOgogIGV4aXN0cygKICAgIChIQy5RdWFsaWZpZWRPYnNlcnZhdGlvbnMoSERFLiJTZWVraW5nIFNURCBUcmVhdG1lbnQiKSkgU2Vla2luZ1RyZWF0bWVudAogICAgICB3aXRoICJQYXRpZW50IEVuY291bnRlciIgUGF0aWVudEVuY291bnRlcgogICAgICAgIHN1Y2ggdGhhdCBGQy5Ub0ludGVydmFsKFNlZWtpbmdUcmVhdG1lbnQuZWZmZWN0aXZlKSBvdmVybGFwcyBQYXRpZW50RW5jb3VudGVyLnBlcmlvZAogICkKCgovKiBQcmVnbmFudCBXb21lbiBXb3JrZmxvdyAqLwovLyBBbGwgV29tZW4gc2hvdWxkIGJlIHNjcmVlbmVkIGF0IEluaXRpYWwgUHJlbmF0YWwgVmlzaXQKLy8gQWxsIHdvbWVuIHNob3VsZCBiZSByZXRlc3RlZCBpbiB0aGUgdGhpcmQgdHJpbWVzdGVyIGlmIHRoZXkncmUgaGlnaCByaXNrCi8vIE5PVEU6IFRoaXMgZGVmaW5pdGlvbiBpbXBsZW1lbnRhdGlvbiBpcyBuYWl2ZSBhbmQgZG9lcyBub3QgdGFrZSBpbnRvIGVmZmVjdCBtdWx0aXBsZSBwcmVnbmFuY2llcy4gQ29uc2lkZXIgdXNlIG9mIGFuIEVwaXNvZGVPZkNhcmUgcmVzb3VyY2UuCmRlZmluZSAiUGF0aWVudCBpcyBhdCBGaXJzdCBQcmVuYXRhbCBWaXNpdCI6CiAgKAogICAgKEZpcnN0KAogICAgICAoSEMuUXVhbGlmaWVkRW5jb3VudGVycyhIREUuIlByZWduYW5jeSBFbmNvdW50ZXJzIikpIFByZWduYW5jeUVuY291bnRlcgogICAgICBzb3J0IGJ5IGVuZCBvZiBwZXJpb2QKICAgICkpIFByZWduYW5jeUVuY291bnRlcgogICAgICB3aXRoICJQYXRpZW50IEVuY291bnRlciIgUGF0aWVudEVuY291bnRlcgogICAgICAgIHN1Y2ggdGhhdCBQcmVnbmFuY3lFbmNvdW50ZXIuaWQgPSBQYXRpZW50RW5jb3VudGVyLmlkCiAgKSBpcyBub3QgbnVsbAoKZGVmaW5lICJQYXRpZW50IGlzIGluIFRoaXJkIFRyaW1lc3RlciBvZiBQcmVnbmFuY3kiOgogICgKICAgIChMYXN0KAogICAgICAoSEMuUXVhbGlmaWVkRW5jb3VudGVycyhIREUuIlRoaXJkIFRyaW1lc3RlciBFbmNvdW50ZXJzIikpIFRoaXJkVHJpbWVzdGVyRW5jb3VudGVyCiAgICBzb3J0IGJ5IGVuZCBvZiBwZXJpb2QKICAgICkpIFRoaXJkVHJpbWVzdGVyRW5jb3VudGVyCiAgICAgIHdpdGggIlBhdGllbnQgRW5jb3VudGVyIiBQYXRpZW50RW5jb3VudGVyCiAgICAgICAgc3VjaCB0aGF0IFRoaXJkVHJpbWVzdGVyRW5jb3VudGVyLmlkID0gUGF0aWVudEVuY291bnRlci5pZAogICkgaXMgbm90IG51bGwKCmRlZmluZSAiUGF0aWVudCBpcyBIaWdoIFJpc2sgaW4gVGhpcmQgVHJpbWVzdGVyIG9mIFByZWduYW5jeSI6CiAgIlBhdGllbnQgaXMgYXQgSGlnaCBSaXNrIGZvciBISVYiCiAgYW5kICJQYXRpZW50IGlzIGluIFRoaXJkIFRyaW1lc3RlciBvZiBQcmVnbmFuY3kiCgoKLyogTVNNIChNZW4gd2hvIGhhdmUgc2V4IHdpdGggbWVuKSAqLwovLyBBdCBMZWFzdCBBbm51YWxseSBmb3Igc2V4dWFsbHkgYWN0aXZlIE1TTSBpZiBISVYgc3RhdHVzIGlzbid0IHBvc2l0aXZlIGFuZCBpZiBwYXRpZW50L3BhcnRuZXIgaGFzIGhhZCBtb3JlIHRoYW4gMSBwYXJ0bmVyIHNpbmNlIHByZXZpb3VzIHNjcmVlbmluZwovLyBGb3Igc2V4dWFsbHkgYWN0aXZlIE1TTSBUZXN0cyBzaG91bGQgb2NjdXIgZXZlcnkgMyBtb250aHMgaWYgdGhlIHBhdGllbnQgaGFzIGV4cGVyaWVuY2VkIHByZXAKZGVmaW5lICJQYXRpZW50IGlzIGEgU2V4dWFsbHkgQWN0aXZlIE1TTSB3aXRob3V0IEhJViI6CiAgIlNleHVhbGx5IEFjdGl2ZSBNU00gUGF0aWVudCIKICBhbmQgIkFjdGl2ZSBEaWFnbm9zaXMgb2YgSElWIER1cmluZyBQYXRpZW50IFZpc2l0IiBpcyBudWxsCgpkZWZpbmUgIlBhdGllbnQgaXMgYSBTZXh1YWxseSBBY3RpdmUgTVNNIHdpdGggTXVsdGlwbGUgU2V4IFBhcnRuZXJzIjoKICAiUGF0aWVudCBpcyBhIFNleHVhbGx5IEFjdGl2ZSBNU00gd2l0aG91dCBISVYiCiAgYW5kICJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBEdWUgdG8gTXVsdGlwbGUgU2V4IFBhcnRuZXJzIHNpbmNlIGxhc3Qgc2NyZWVuaW5nIgoKZGVmaW5lICJQYXRpZW50IGlzIGEgU2V4dWFsbHkgQWN0aXZlIE1TTSB3aG8gc2hvdWxkIGJlIFNjcmVlbmVkIEFubnVhbGx5IjoKICAiUGF0aWVudCBpcyBhIFNleHVhbGx5IEFjdGl2ZSBNU00gd2l0aCBNdWx0aXBsZSBTZXggUGFydG5lcnMiCiAgYW5kICJPdmVyIGEgWWVhciBoYXMgUGFzdCBTaW5jZSBQcmV2aW91cyBISVYgU2NyZWVuaW5nIgoKZGVmaW5lICJQYXRpZW50IGlzIGEgU2V4dWFsbHkgQWN0aXZlIE1TTSB3aG8gc2hvdWxkIGJlIFNjcmVlbmVkIEV2ZXJ5IDMgTW9udGhzIjoKICAiUGF0aWVudCBpcyBhIFNleHVhbGx5IEFjdGl2ZSBNU00gd2l0aG91dCBISVYiCiAgYW5kICJQYXRpZW50IGhhcyBSZWNlaXZlZCBQcmUgRXhwb3N1cmUgUHJvcGh5bGF4aXMiCiAgYW5kICJPdmVyIDMgTW9udGhzIGhhcyBQYXN0IFNpbmNlIFByZXZpb3VzIEhJViBTY3JlZW5pbmciCgoKLyogRHJ1ZyBBYnVzZSBTY3JlbmluZyBUZXN0IChEQVNULTEwKSBRdWVzdGlvbm5haXJlICovCi8vIFNjb3JlIGFjcXVpcmVkIGVpdGhlciBieSB0YWxseWluZyBjb2RlcyBmb3IgREFTVC0xMCBxdWVzdGlvbnMgb3IgYnkgdGhlIHZhbHVlIGZpZWxkIG9mIERBU1QtMTAgUXVlc3Rpb25uYWlyZSBvciByZXN1bHQgY29kZXMKLy8gSGlnaCBSaXNrOiA+PSA2Ci8vIE5vcm1hbCBSaXNrOiAzIC0gNQovLyBMb3cgUmlzazogMSAtIDIKLy8gTm8gUmlzazogMAoKZGVmaW5lICJEQVNUIDEwIFJlc3VsdCBTY29yZSI6CiAgKExhc3QoCiAgICAoSERFLiJEQVNUIDEwIFF1ZXN0aW9ubmFpcmUiIHNjcmVlbmluZwogICAgICB3aGVyZSBzY3JlZW5pbmcudmFsdWUgaXMgbm90IG51bGwpIG5vdE51bGxTY3JlZW5pbmcKICAgICAgc29ydCBieSBzdGFydCBvZiBGQy5Ub0ludGVydmFsKGVmZmVjdGl2ZSkpCiAgKSBsYXRlc3RTY3JlZW5pbmcKICByZXR1cm4gKGxhdGVzdFNjcmVlbmluZy52YWx1ZSBhcyBpbnRlZ2VyKS52YWx1ZQoKZGVmaW5lICJBbGwgREFTVCAxMCBRdWVzdGlvbnMiOgogIEhERS4iREFTVCAxMCBRdWVzdGlvbiAxIgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiAyIgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiAzIgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiA0IgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiA1IgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiA2IgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiA3IgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiA4IgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiA5IgogIHVuaW9uIEhERS4iREFTVCAxMCBRdWVzdGlvbiAxMCIKCmRlZmluZSAiTGF0ZXN0IERBU1QgMTAgUXVlc3Rpb25zIERhdGUiOgogIChMYXN0KAogICAgKCJBbGwgREFTVCAxMCBRdWVzdGlvbnMiKSBxdWVzdGlvbnMKICAgIHNvcnQgYnkgc3RhcnQgb2YgRkMuVG9JbnRlcnZhbChlZmZlY3RpdmUpKQogICkgbGF0ZXN0UXVlc3Rpb24KICByZXR1cm4gZGF0ZSBmcm9tIHN0YXJ0IG9mIEZDLlRvSW50ZXJ2YWwobGF0ZXN0UXVlc3Rpb24uZWZmZWN0aXZlKQoKZGVmaW5lICJEQVNUIDEwIFF1ZXN0aW9ucyBTY29yZSI6CiAgQ291bnQoCiAgICAiQWxsIERBU1QgMTAgUXVlc3Rpb25zIiBxdWVzdGlvbgogICAgICB3aGVyZSBzdGFydCBvZiBGQy5Ub0ludGVydmFsKHF1ZXN0aW9uLmVmZmVjdGl2ZSkgc2FtZSBkYXkgYXMgIkxhdGVzdCBEQVNUIDEwIFF1ZXN0aW9ucyBEYXRlIgogICAgICBhbmQgQ29hbGVzY2UoTG93ZXIocXVlc3Rpb24udmFsdWUgYXMgc3RyaW5nKSBpbiB7ICd5ZXMnIH0sIHF1ZXN0aW9uLnZhbHVlIGFzIGJvb2xlYW4gPSB0cnVlKQogICkKCmRlZmluZSAiTGF0ZXN0IERBU1QgMTAgU2NyZWVuaW5nIERhdGUiOgogIChMYXN0KAogICAgKEhERS4iREFTVCAxMCBRdWVzdGlvbm5haXJlIgogICAgdW5pb24gIkFsbCBEQVNUIDEwIFF1ZXN0aW9ucyIpIHJlc3VsdHMKICAgIHNvcnQgYnkgc3RhcnQgb2YgRkMuVG9JbnRlcnZhbChlZmZlY3RpdmUpKQogICkgbGF0ZXN0U2NyZWVuaW5nCiAgcmV0dXJuIGRhdGUgZnJvbSBzdGFydCBvZiBGQy5Ub0ludGVydmFsKGxhdGVzdFNjcmVlbmluZy5lZmZlY3RpdmUpCgovLyJQYXRpZW50IGlzIGF0IEhpZ2ggUmlzayBEdWUgdG8gYSBTVEQiCmRlZmluZSAiUGF0aWVudCBIYXMgSGlnaCBEZWdyZWUgT2YgUHJvYmxlbXMgUmVsYXRlZCBUbyBEcnVnIEFidXNlIjoKICAoIkRBU1QgMTAgUmVzdWx0IFNjb3JlIiBpbiAiREFTVCAxMCBIaWdoIFJpc2sgU2NvcmUiKQogIG9yCiAgKCJEQVNUIDEwIFF1ZXN0aW9ucyBTY29yZSIgaW4gIkRBU1QgMTAgSGlnaCBSaXNrIFNjb3JlIikKCmRlZmluZSAiUGF0aWVudCBIYXMgTW9kZXJhdGUgRGVncmVlIE9mIFByb2JsZW1zIFJlbGF0ZWQgVG8gRHJ1ZyBBYnVzZSI6CiAgKCJEQVNUIDEwIFJlc3VsdCBTY29yZSIgaW4gIkRBU1QgMTAgTW9kZXJhdGUgUmlzayBTY29yZSIpCiAgb3IKICAoIkRBU1QgMTAgUXVlc3Rpb25zIFNjb3JlIiBpbiAiREFTVCAxMCBNb2RlcmF0ZSBSaXNrIFNjb3JlIikKCmRlZmluZSAiUGF0aWVudCBIYXMgTG93IERlZ3JlZSBPZiBQcm9ibGVtcyBSZWxhdGVkIFRvIERydWcgQWJ1c2UiOgogICgiREFTVCAxMCBSZXN1bHQgU2NvcmUiIGluICJEQVNUIDEwIExvdyBSaXNrIFNjb3JlIikKICBvcgogICgiREFTVCAxMCBRdWVzdGlvbnMgU2NvcmUiIGluICJEQVNUIDEwIExvdyBSaXNrIFNjb3JlIikKCmRlZmluZSAiUGF0aWVudCBIYXMgTG93IFRvIE1vZGVyYXRlIERlZ3JlZSBPZiBQcm9ibGVtcyBSZWxhdGVkIFRvIERydWcgQWJ1c2UiOgogICJQYXRpZW50IEhhcyBMb3cgRGVncmVlIE9mIFByb2JsZW1zIFJlbGF0ZWQgVG8gRHJ1ZyBBYnVzZSIKICBvcgogICJQYXRpZW50IEhhcyBNb2RlcmF0ZSBEZWdyZWUgT2YgUHJvYmxlbXMgUmVsYXRlZCBUbyBEcnVnIEFidXNlIgoKZGVmaW5lICJQYXRpZW50IEhhcyBObyBQcm9ibGVtcyBSZWxhdGVkIFRvIERydWcgQWJ1c2UiOgogICgiREFTVCAxMCBSZXN1bHQgU2NvcmUiIGluICJEQVNUIDEwIE5vIFJpc2sgU2NvcmUiKQogIG9yCiAgKCJEQVNUIDEwIFF1ZXN0aW9ucyBTY29yZSIgaXMgbnVsbCkKCmRlZmluZSAiUGF0aWVudCBOb3QgU2NyZWVuZWQgRm9yIERydWcgQWJ1c2UgT3IgU2NyZWVuaW5nIEV4cGlyZWQiOgogICgiTGF0ZXN0IERBU1QgMTAgU2NyZWVuaW5nIERhdGUiIGlzIG51bGwpCiAgb3IKICAoZGlmZmVyZW5jZSBpbiB5ZWFycyBiZXR3ZWVuICJMYXRlc3QgREFTVCAxMCBTY3JlZW5pbmcgRGF0ZSIgYW5kIFRvZGF5KCkgPj0gMSkKCmRlZmluZSAiREFTVCAxMCBIaWdoIFJpc2sgU2NvcmUiOgogIEludGVydmFsWzYsMTBdCgpkZWZpbmUgIkRBU1QgMTAgTW9kZXJhdGUgUmlzayBTY29yZSI6CiAgSW50ZXJ2YWxbMyw1XQoKZGVmaW5lICJEQVNUIDEwIExvdyBSaXNrIFNjb3JlIjoKICBJbnRlcnZhbFsxLDJdCgpkZWZpbmUgIkRBU1QgMTAgTm8gUmlzayBTY29yZSI6CiAgSW50ZXJ2YWxbMCwwXQo="
  } ]
}